{
    "name": "Integration tests",
    "description": {
        "author": "Julien Vehent",
        "email": "ulfr@mozilla.com",
        "revision": 201409031000
    },
    "target": "agents.os = 'linux'",
    "threat": {
        "level": "-",
        "family": "test"
    },
    "operations": [
        {
            "module": "filechecker",
            "parameters": {
                "searches": {
                    "sshnotmatch": {
                        "paths": [
                            "/home/*/.ssh/*"
                        ],
                        "regexes": [
                            "should not match"
                        ]
                    },
                    "yumshouldmatch": {
                        "paths": [
                            "/etc/*yum*/*.repo"
                        ],
                        "regexes": [
                            "^gpgcheck=1$"
                        ]
                    },
                    "etcshouldmatch": {
                        "paths": [
                            "/etc/"
                        ],
                        "regexes": [
                            "^jvehent:"
                        ]
                    },
                    "shadownotmatch": {
                        "paths": [
                            "/etc/shadow"
                        ],
                        "regexes": [
                            "^shouldnotmatch$"
                        ],
                        "filenames": [
                            "^bob$"
                        ]
                    },
                    "shadowmatch": {
                        "paths": [
                            "/etc/shadow"
                        ],
                        "regexes": [
                            "^root:"
                        ],
                        "filenames": [
                            "^shadow$"
                        ]
                    }
                }
            }
        }
    ],
    "syntaxversion": 2
}
