<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link href="docstyle.css" rel="stylesheet" />
    <title>Mozilla InvestiGator Cheat Sheet</title>
    <meta content="Guillaume Destuynder &lt;kang@mozilla.com&gt;" name="author" />
</head>
<body>
    <h1>Mozilla InvestiGator Cheat Sheet</h1>
    <aside class="topic contents" id="table-of-contents">
        <h1>Table of Contents</h1>
        <ul class="auto-toc">
            <li><a href="#file-filechecker-module-operations">1   File/Filechecker module operations</a></li>
        </ul>
    </aside>
    <p>This is a list of common operations you may want to run with MIG.</p>
    <section id="file-filechecker-module-operations">
        <h2>1   File/Filechecker module operations</h2>
        <ul>
            <li>Find if files in /etc/cron.d contain "mysql://" on hosts "<em>buildbot</em>"</li>
        </ul>
        <pre><code class="bash">mig file -t <span class="s2">"os='linux' AND name like '%buildbot%'"</span> -path /etc/cron.d/ -content <span class="s2">"mysql://"</span></code></pre>
        <ul>
            <li>Find if file /etc/passwd has been modified in the past 2 days</li>
        </ul>
        <pre><code class="bash">mig file -t <span class="s2">"os='linux'"</span> -path /etc/passwd -mtime &lt;2d</code></pre>
        <ul>
            <li>Find endpoints with high uptime</li>
        </ul>
        <pre><code class="bash">mig file -t <span class="s2">"os='linux' OR os='darwin'"</span> -path /proc/uptime -content <span class="s2">"^[5-9]{1}[0-9]{7,}\\."</span></code></pre>
        <ul>
            <li>Find endpoints running process "/sbin/auditd"</li>
        </ul>
        <pre><code class="bash">mig file -t <span class="s2">"os='linux'"</span> -path /proc/ -name cmdline -content <span class="s2">"/sbin/auditd"</span></code></pre>
    </section>
</body>
</html>